let diseñador="\nDISEÑADOR:\n///////////////////////////////////////////////////////\n//  _   _   _                                   ___  //\n// ||X  X|--||  ||XXX|XX ||--  XX  ||   ||   -- X || //\n// || XX||||||  ||---|| X|||| XXXX ||   ||   ||  X   //\n// ||   |||||XXX||XXX||  X|||XX  XX||XXX||XXX||||_X  //\n//                                                   //\n///////////////////////////////////////////////////////";console.log(diseñador);const state={files:[],rootPath:"/inicio"},fileListElem=document.querySelector("#app"),loadingElem=document.querySelector(".loading");let ruta=new Set,i=0,thumbnail;const dbx=new Dropbox.Dropbox({accessToken:"3SDa6adnXMAAAAAAAAAAITh5fAMaV2BH1jyNunMbMmKO_PCDczLNIhBuoIYU3v71",fetch:fetch}),init=async()=>{let res=await dbx.filesListFolder({path:state.rootPath,limit:50}),carpetas,archivos;actualizar(res),document.querySelectorAll("#path").forEach(elemento=>{elemento.addEventListener("click",e=>{if(loadingElem.classList.remove("hidden"),elemento.children[1].dataset.name.toLowerCase().includes(" ")){let nombre=elemento.children[1].dataset.name.toLowerCase().split(" ").join("-");ruta.add(`/${nombre}`),console.log(ruta)}else ruta.add(`/${elemento.children[1].dataset.name.toLowerCase()}`);location.hash=Array.from(ruta).join("")})}),document.querySelectorAll("#file").forEach(elemento=>{dbx.filesDownload({path:elemento.dataset.path}).then((function(response){let downloadUrl=URL.createObjectURL(response.fileBlob);elemento.setAttribute("href",downloadUrl),elemento.setAttribute("download",response.name)})).catch((function(error){console.error(error)}))}),loadingElem.classList.add("hidden")},reset=()=>{state.files=[],init()},actualizar=files=>{state.files=[...state.files,...files.entries],renderizar()};function esExtencion(extension){return console.log(extension),extension.slice(0,3)}const renderizar=()=>{fileListElem.innerHTML=state.files.sort((a,b)=>"folder"!==a[".tag"]&&"folder"!==b[".tag"]||a[".tag"]===b[".tag"]?a.name.toLowerCase()<b.name.toLowerCase()?-1:1:"folder"===a[".tag"]?-1:1).map(file=>{const type=file[".tag"];if(1!==ruta.size){if(fileListElem.className="wrapper-secundario","file"===type){let extencion=esExtencion(file.path_lower.split(".")[1]);return`<a id="file" data-path="${file.path_lower}">\n        <div class="directorio-principal-secundario  pointer">\n        <div class="over-flow-secundario ${extencion}"></div>\n        <p class="texto-secundario">${file.name.split(".")[0]}</p>\n    </div>\n    </a>`}return`<div id="path" data-path="${file.path_lower}" class="directorio-principal-secundario  pointer">\n        <div class="over-flow-secundario path"></div>\n        <p class="texto-secundario" data-name="${file.name}">${file.name}</p>\n    </div>`}if(fileListElem.className="wrapper-inicio","file"!==type){let rutaImagen=`./img/${file.name.replace(/[0-9] */g,"")}.png`;return`<div id="path" data-path="${file.path_lower}"             class="directorio-principal-inicio  pointer ${file.name.replace(/[0-9] */g,"").toLowerCase()}">\n                <div class="over-flow-inicio"><img src="${rutaImagen.toLowerCase()}" alt=""></div>\n                <p class="texto-inicio" data-name="${file.name}" >${file.name.replace(/[0-9] */g,"")}</p>\n            </div>`}}).join("")},obtenerIcono=async files=>{const resImg=await dbx.filesGetThumbnailBatch({entries:files.entries.map((function(entry){return{path:entry.id,format:{".tag":"png"},size:{".tag":"w2048h1536"}}}))}),newStateFiles=[...state.files];resImg.entries.forEach(e=>{if("success"===e[".tag"]){let indexToUpdate=state.files.findIndex(stateFile=>e.metadata.path_lower===stateFile.path_lower);newStateFiles[indexToUpdate].thumbnail=e.thumbnail}}),state.files=newStateFiles,renderizar()};window.addEventListener("hashchange",()=>{loadingElem.classList.remove("hidden");let hashid=location.hash.split("#")[1];hashid.includes("-")?(hashid=hashid.toLowerCase().split("-").join(" "),state.rootPath=hashid,hashid=hashid.toLowerCase().split(" ").join("-")):state.rootPath=hashid,ruta.clear(),hashid.split("/").forEach(e=>{""===e||ruta.add(`/${e}`)}),reset()}),console.log(location.hash),location.hash=state.rootPath,console.log(location.hash),ruta.add(location.hash.split("#")[1]),console.log(ruta);